(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{79496:(e,s,t)=>{Promise.resolve().then(t.bind(t,39589))},39589:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>ej});var a=t(95155),l=t(12115),r=t(6698),n=t(38698),i=t(14081),d=t(43831),c=t(68236),o=t(40767),x=t(86710),m=t(46967),h=t(14505),u=t(20853),g=t(20994),j=t(58197),p=t(65753),b=t(92823),f=t(30312),v=t(87780),N=t(73580),y=t(91902),w=t(51719),k=t(17146);function S(){let e;let{user:s,canEdit:t}=(0,k.A)(),[i,d]=(0,l.useState)([]),[x,m]=(0,l.useState)(!0),[g,j]=(0,l.useState)(null),[p,b]=(0,l.useState)(""),[f,S]=(0,l.useState)(null),[C,A]=(0,l.useState)([]),[E,O]=(0,l.useState)(!1),[D,F]=(0,l.useState)({}),[L,R]=(0,l.useState)(null),[K,I]=(0,l.useState)(!1),z=["דגם","יצרן","קבוצה","סטטוס","אזור","בעלים","טלפון בעלים","מקור"];(0,l.useEffect)(()=>{(async()=>{try{let e=(0,n.KR)(r.O,"/data/data"),s=await (0,n.Jt)(e);if(s.exists()){let e=s.val(),t=Array.isArray(e)?e:[];if(d(t),t.length>0){let e=Array.from(new Set(t.flatMap(e=>Object.keys(e)))).map(e=>({key:e,visible:z.includes(e),priority:z.indexOf(e)}));e.sort((e,s)=>-1===e.priority&&-1===s.priority?e.key.localeCompare(s.key,"he"):-1===e.priority?1:-1===s.priority?-1:e.priority-s.priority),A(e)}}}catch(e){console.error("Database error:",e),j(e instanceof Error?e.message:"Error loading data")}finally{m(!1)}})()},[]);let J=async(e,t,a)=>{if(!s){alert("יש להתחבר כדי לערוך נתונים"),R(null);return}try{I(!0);let s=M[e],l={...s,[t]:a},i=(0,n.KR)(r.O,"/data/data/".concat(e));await (0,n.hZ)(i,l),d(e=>{let t=[...e],a=e.findIndex(e=>Object.entries(e).every(e=>{let[t,a]=e;return s[t]===a}));return -1!==a&&(t[a]=l),t}),R(null)}catch(e){console.error("Error updating cell:",e),"PERMISSION_DENIED"===e.code?alert("אין לך הרשאות לעריכת נתונים"):alert("שגיאה בעדכון הנתונים. אנא נסה שנית"),R(null)}finally{I(!1)}},_=(e,s,l)=>{let r=(null==L?void 0:L.rowIndex)===l&&(null==L?void 0:L.columnKey)===s,n=e[s];return r&&t?(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("input",{autoFocus:!0,className:"w-full px-2 py-1 border rounded text-right",value:L.value,onChange:e=>R({...L,value:e.target.value}),onKeyPress:e=>{"Enter"===e.key&&J(l,s,L.value)},onBlur:()=>R(null)}),(0,a.jsx)("button",{onClick:()=>J(l,s,L.value),className:"p-1 text-green-600 hover:text-green-800",disabled:K,children:(0,a.jsx)(v.A,{className:"h-4 w-4"})})]}):(0,a.jsxs)("div",{className:"group flex items-center justify-between",children:[t&&(0,a.jsx)("button",{onClick:()=>R({rowIndex:l,columnKey:s,value:(null==n?void 0:n.toString())||""}),className:"opacity-0 group-hover:opacity-100 p-1 text-gray-400 hover:text-gray-600",children:(0,a.jsx)(N.A,{className:"h-4 w-4"})}),(0,a.jsx)("span",{children:"לא ידוע"===n?(0,a.jsx)("span",{className:"text-gray-400",children:"-"}):(null==n?void 0:n.toString())||"-"})]})},B=C.filter(e=>e.visible),M=(e=[...i],p&&(e=e.filter(e=>Object.values(e).some(e=>null==e?void 0:e.toString().toLowerCase().includes(p.toLowerCase())))),Object.entries(D).forEach(s=>{let[t,a]=s;a&&(e=e.filter(e=>{var s;return null===(s=e[t])||void 0===s?void 0:s.toString().toLowerCase().includes(a.toLowerCase())}))}),f&&e.sort((e,s)=>{var t,a;let l=(null===(t=e[f.key])||void 0===t?void 0:t.toString())||"",r=(null===(a=s[f.key])||void 0===a?void 0:a.toString())||"";return"asc"===f.direction?l.localeCompare(r,"he"):r.localeCompare(l,"he")}),e);return x?(0,a.jsxs)("div",{className:"flex items-center justify-center min-h-[200px]",children:[(0,a.jsx)(h.A,{className:"w-8 h-8 animate-spin text-blue-500"}),(0,a.jsx)("span",{className:"mr-2 text-gray-600",children:"טוען נתונים..."})]}):(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-lg p-6",children:[(0,a.jsxs)("div",{className:"flex flex-col gap-4 mb-6",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("h2",{className:"text-2xl font-bold",children:"רשימת כלי רכב"}),(0,a.jsxs)("div",{className:"flex gap-3",children:[(0,a.jsxs)("button",{onClick:()=>O(!E),className:"flex items-center gap-2 px-4 py-2 bg-blue-50 text-blue-600 rounded-lg hover:bg-blue-100 transition-colors",children:[(0,a.jsx)(c.A,{className:"h-5 w-5"}),"ניהול עמודות"]}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(u.A,{className:"absolute right-3 top-2.5 h-5 w-5 text-gray-400"}),(0,a.jsx)("input",{type:"text",placeholder:"חיפוש...",className:"w-64 pl-4 pr-10 py-2 border rounded-lg text-right",value:p,onChange:e=>b(e.target.value)})]})]})]}),E&&(0,a.jsx)("div",{className:"bg-gray-50 p-4 rounded-lg",children:(0,a.jsx)("div",{className:"flex flex-wrap gap-2 max-h-40 overflow-y-auto",children:C.map(e=>(0,a.jsxs)("button",{onClick:()=>A(s=>s.map(s=>s.key===e.key?{...s,visible:!s.visible}:s)),className:"px-3 py-1.5 rounded-full text-sm flex items-center gap-2 transition-colors ".concat(e.visible?"bg-blue-100 text-blue-700":"bg-gray-200 text-gray-600"),children:[e.key,e.visible?(0,a.jsx)(o.A,{className:"h-4 w-4"}):(0,a.jsx)("span",{children:"+"})]},e.key))})}),Object.keys(D).length>0&&(0,a.jsx)("div",{className:"flex flex-wrap gap-2",children:Object.entries(D).map(e=>{let[s,t]=e;return(0,a.jsxs)("div",{className:"bg-blue-50 text-blue-700 px-3 py-1 rounded-full text-sm flex items-center gap-2",children:[s,": ",t,(0,a.jsx)(o.A,{className:"h-4 w-4 cursor-pointer hover:text-blue-900",onClick:()=>{let e={...D};delete e[s],F(e)}})]},s)})})]}),(0,a.jsx)("div",{className:"border rounded-lg overflow-hidden",children:(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,a.jsx)("thead",{className:"bg-gray-50 sticky top-0",children:(0,a.jsx)("tr",{children:B.map(e=>(0,a.jsx)("th",{className:"group px-6 py-3 text-right text-sm font-medium text-gray-500 cursor-pointer hover:bg-gray-100",onClick:()=>S({key:e.key,direction:(null==f?void 0:f.key)===e.key&&"asc"===f.direction?"desc":"asc"}),children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("div",{className:"opacity-0 group-hover:opacity-100 transition-opacity",children:(0,a.jsx)("input",{onClick:e=>e.stopPropagation(),placeholder:"סנן",className:"w-20 px-2 py-1 text-xs border rounded",value:D[e.key]||"",onChange:s=>F(t=>({...t,[e.key]:s.target.value}))})}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[e.key,(null==f?void 0:f.key)===e.key&&("asc"===f.direction?(0,a.jsx)(y.A,{className:"h-4 w-4"}):(0,a.jsx)(w.A,{className:"h-4 w-4"}))]})]})},e.key))})}),(0,a.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:M.map((e,s)=>(0,a.jsx)("tr",{className:"hover:bg-gray-50 transition-colors",children:B.map(t=>(0,a.jsx)("td",{className:"px-6 py-4 text-sm text-gray-900",children:(0,a.jsx)("div",{className:"text-right",children:_(e,t.key,s)})},t.key))},s))})]})})}),(0,a.jsxs)("div",{className:"mt-4 text-sm text-gray-500 flex justify-between items-center",children:[(0,a.jsxs)("div",{children:["מציג ",M.length," מתוך ",i.length," רשומות"]}),(0,a.jsxs)("div",{children:["עמודות מוצגות: ",B.length," מתוך ",C.length]})]})]})}var C=t(84267);let A=(0,t(77711).default)(()=>Promise.all([t.e(761),t.e(317)]).then(t.bind(t,51317)),{loadableGenerated:{webpack:()=>[51317]},ssr:!1,loading:()=>(0,a.jsx)("div",{className:"flex items-center justify-center h-[60vh]",children:(0,a.jsx)(h.A,{className:"w-8 h-8 animate-spin text-blue-500"})})});function E(){let[e,s]=(0,l.useState)([]),[t,i]=(0,l.useState)(!0),[d,c]=(0,l.useState)(null),[x,m]=(0,l.useState)(""),[g,j]=(0,l.useState)([]),[p,b]=(0,l.useState)({}),[f,v]=(0,l.useState)({}),[N,y]=(0,l.useState)(!1),[w,k]=(0,l.useState)(0),S=["שנתון","מקור","קבוצה","אזור","דגם","יצרן","תקין"];(0,l.useEffect)(()=>{(async()=>{try{let e=(0,n.KR)(r.O,"/data/data"),t=await (0,n.Jt)(e);if(t.exists()){let e=t.val(),a=Array.isArray(e)?e:[];s(a);let l={};S.forEach(e=>{let s=Array.from(new Set(a.map(s=>{var t;return(null===(t=s[e])||void 0===t?void 0:t.toString())||""}))).filter(Boolean).sort();l[e]=s}),b(l),E(a,x,{})}}catch(e){console.error("Database error:",e),c(e instanceof Error?e.message:"Error loading data")}finally{i(!1)}})()},[]);let E=(e,s,t)=>{let a=e.filter(e=>"אורך"!=e["מקור"]&&"32.06"!=e["רוחב"]&&e["אורך"]&&e["רוחב"]);s&&(a=a.filter(e=>Object.entries(e).some(e=>{let[t,a]=e;return null==a?void 0:a.toString().toLowerCase().includes(s.toLowerCase())}))),Object.entries(t).forEach(e=>{let[s,t]=e;t&&(a=a.filter(e=>{var a;return(null===(a=e[s])||void 0===a?void 0:a.toString())===t}))}),j(a),k(e=>e+1)};(0,l.useEffect)(()=>{E(e,x,f)},[x,f,e]);let O=e=>{let s={...f};delete s[e],v(s)};return t?(0,a.jsxs)("div",{className:"flex items-center justify-center min-h-[200px]",children:[(0,a.jsx)(h.A,{className:"w-8 h-8 animate-spin text-blue-500"}),(0,a.jsx)("span",{className:"mr-2 text-gray-600",children:"טוען נתונים..."})]}):d?(0,a.jsxs)("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded text-right",children:["שגיאה: ",d]}):(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-lg p-6",dir:"rtl",children:[(0,a.jsxs)("div",{className:"flex flex-col gap-4 mb-6",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("h2",{className:"text-2xl font-bold",children:"מפת כלי רכב"}),(0,a.jsxs)("div",{className:"flex gap-3",children:[(0,a.jsxs)("button",{onClick:()=>y(!N),className:"flex items-center gap-2 px-4 py-2 rounded-lg border transition-colors ".concat(N?"bg-blue-50 text-blue-600 border-blue-200":"hover:bg-gray-50"),children:[(0,a.jsx)(C.A,{className:"h-5 w-5"}),"סינון"]}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(u.A,{className:"absolute right-3 top-2.5 h-5 w-5 text-gray-400"}),(0,a.jsx)("input",{type:"text",placeholder:"חיפוש...",className:"w-64 pl-4 pr-10 py-2 border rounded-lg text-right",value:x,onChange:e=>m(e.target.value)})]})]})]}),N&&(0,a.jsx)("div",{className:"bg-gray-50 p-4 rounded-lg",children:(0,a.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:S.map(e=>{var s;return(0,a.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,a.jsx)("label",{className:"text-sm font-medium text-gray-700",children:e}),(0,a.jsxs)("select",{className:"w-full p-2 border rounded-lg text-right",value:f[e]||"",onChange:s=>{let t={...f};s.target.value?t[e]=s.target.value:delete t[e],v(t)},children:[(0,a.jsx)("option",{value:"",children:"הכל"}),null===(s=p[e])||void 0===s?void 0:s.map(e=>(0,a.jsx)("option",{value:e,children:e},e))]})]},e)})})}),Object.keys(f).length>0&&(0,a.jsx)("div",{className:"flex flex-wrap gap-2",children:Object.entries(f).map(e=>{let[s,t]=e;return(0,a.jsxs)("div",{className:"bg-blue-50 text-blue-700 px-3 py-1 rounded-full text-sm flex items-center gap-2",children:[s,": ",t,(0,a.jsx)(o.A,{className:"h-4 w-4 cursor-pointer hover:text-blue-900",onClick:()=>O(s)})]},s)})})]}),(0,a.jsx)("div",{className:"h-[60vh] border rounded-lg overflow-hidden",children:(0,a.jsx)(A,{data:g},w)}),(0,a.jsxs)("div",{className:"mt-4 text-sm text-gray-500 flex justify-between items-center",children:[(0,a.jsxs)("div",{children:["מציג ",g.length," מתוך ",e.length," רשומות"]}),(0,a.jsx)("div",{children:0===Object.keys(f).length?"מציג רק נתונים מ: איתורן, פוינטר":"מסנן לפי ".concat(Object.keys(f).length," שדות")})]})]})}var O=t(66889),D=t(57223);let F=e=>new Date(e).toLocaleDateString("he-IL",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}),L=e=>{let{data:s,region:t}=e,[r,n]=(0,l.useState)(null),[i,d]=(0,l.useState)(null),[c,o]=(0,l.useState)(""),x=[...s.current.filter(e=>Object.values(e).some(e=>null==e?void 0:e.toString().toLowerCase().includes(c.toLowerCase())))].sort((e,s)=>{if(i){var t,a;let l=(null===(t=e[i.key])||void 0===t?void 0:t.toString())||"",r=(null===(a=s[i.key])||void 0===a?void 0:a.toString())||"";return"asc"===i.direction?l.localeCompare(r,"he"):r.localeCompare(l,"he")}return 0});return(0,a.jsxs)("div",{className:"mt-4",children:[(0,a.jsxs)("div",{className:"mb-4 flex justify-between items-center",children:[(0,a.jsxs)("h3",{className:"text-xl font-bold",children:["נתוני ",t]}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(u.A,{className:"absolute right-3 top-2.5 h-5 w-5 text-gray-400"}),(0,a.jsx)("input",{type:"text",placeholder:"חיפוש בטבלה...",className:"w-64 pl-4 pr-10 py-2 border rounded-lg text-right",value:c,onChange:e=>o(e.target.value)})]})]}),(0,a.jsx)("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,a.jsx)("thead",{className:"bg-gray-50",children:(0,a.jsx)("tr",{children:["קוד רכב","סטטוס","חותמת זמן","היסטוריה"].map(e=>(0,a.jsx)("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer",onClick:()=>"היסטוריה"!==e&&d({key:e,direction:(null==i?void 0:i.key)===e&&"asc"===i.direction?"desc":"asc"}),children:(0,a.jsxs)("div",{className:"flex items-center justify-end gap-2",children:[e,(null==i?void 0:i.key)===e&&("asc"===i.direction?(0,a.jsx)(y.A,{className:"h-4 w-4"}):(0,a.jsx)(w.A,{className:"h-4 w-4"}))]})},e))})}),(0,a.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:x.map(e=>{var t,i;let d=(null===(t=e["קוד רכב"])||void 0===t?void 0:t.toString())||Math.random().toString();return(0,a.jsxs)(l.Fragment,{children:[(0,a.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-right",children:e["קוד רכב"]}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-right",children:(0,a.jsx)("span",{className:"px-2 inline-flex text-xs leading-5 font-semibold rounded-full ".concat("פעיל"===e["סטטוס"]?"bg-green-100 text-green-800":"לא פעיל"===e["סטטוס"]?"bg-red-100 text-red-800":"bg-yellow-100 text-yellow-800"),children:e["סטטוס"]})}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-right",children:F(e["חותמת זמן"])}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-right",children:(null===(i=s.history[e["קוד רכב"]])||void 0===i?void 0:i.length)>0&&(0,a.jsxs)("button",{onClick:()=>n(r===e["קוד רכב"]?null:e["קוד רכב"]),className:"text-blue-600 hover:text-blue-800 flex items-center gap-1",children:[(0,a.jsx)(O.A,{className:"h-4 w-4"}),s.history[e["קוד רכב"]].length," רשומות"]})})]}),r===e["קוד רכב"]&&(0,a.jsx)("tr",{children:(0,a.jsx)("td",{colSpan:6,className:"px-6 py-4",children:(0,a.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4",children:[(0,a.jsxs)("h4",{className:"text-lg font-medium mb-2",children:["היסטוריית רכב ",e["קוד רכב"]]}),(0,a.jsx)("div",{className:"space-y-2",children:s.history[e["קוד רכב"]].map((e,s)=>(0,a.jsx)("div",{className:"bg-white p-3 rounded-lg shadow-sm",children:(0,a.jsxs)("div",{className:"grid grid-cols-3 gap-4 text-right",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"font-medium",children:"תאריך: "}),F(e["חותמת זמן"])]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"font-medium",children:"סטטוס: "}),e["סטטוס"]]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"font-medium",children:"תת-סטטוס: "}),e["תת-סטטוס"]]})]})},"".concat(d,"-history-").concat(e["חותמת זמן"])))})]})})},"history-".concat(d))]},d)})})]})})})]})};function R(){var e,s,t,i,d,c;let[o,x]=(0,l.useState)(!0),[m,h]=(0,l.useState)(null),[u,g]=(0,l.useState)(null),[j,p]=(0,l.useState)({מרכז:{count:0,stats:{total:0,תפוס:0,מגוייס:0},data:{current:[],history:{}}},צפון:{count:0,stats:{total:0,תפוס:0,מגוייס:0},data:{current:[],history:{}}},דרום:{count:0,stats:{total:0,תפוס:0,מגוייס:0},data:{current:[],history:{}}}});return((0,l.useEffect)(()=>{(async()=>{try{let e=(0,n.KR)(r.O,"/recruited"),s=await (0,n.Jt)(e);if(s.exists()){let e=s.val(),t={מרכז:{current:[],history:{}},צפון:{current:[],history:{}},דרום:{current:[],history:{}}};e.forEach(e=>{if(e['יצ"מ']&&e["קוד רכב"]){let s=e['יצ"מ'],a=e["קוד רכב"];t[s]||(t[s]={current:[],history:{}}),t[s].history[a]||(t[s].history[a]=[]),t[s].history[a].push(e)}});let a=e=>({total:e.length,תפוס:e.filter(e=>"תפוס"===e["סטטוס"]).length,מגוייס:e.filter(e=>"מגוייס"===e["סטטוס"]).length});Object.keys(t).forEach(e=>{Object.keys(t[e].history).forEach(s=>{let a=t[e].history[s];a.sort((e,s)=>new Date(s["חותמת זמן"]).getTime()-new Date(e["חותמת זמן"]).getTime());let l=a[0];l["סטטוס"]&&t[e].current.push(l),t[e].history[s]=a.slice(1)})}),p({מרכז:{count:t["מרכז"].current.length,stats:a(t["מרכז"].current),data:t["מרכז"]},צפון:{count:t["צפון"].current.length,stats:a(t["צפון"].current),data:t["צפון"]},דרום:{count:t["דרום"].current.length,stats:a(t["דרום"].current),data:t["דרום"]}})}}catch(e){console.error("Database error:",e),h(e instanceof Error?e.message:"Error loading data")}finally{x(!1)}})()},[]),o)?(0,a.jsxs)("div",{className:"flex items-center justify-center min-h-[200px]",children:[(0,a.jsx)("div",{className:"w-8 h-8 border-4 border-blue-500 border-t-transparent rounded-full animate-spin"}),(0,a.jsx)("span",{className:"mr-2 text-gray-600",children:"טוען נתונים..."})]}):m?(0,a.jsxs)("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded text-right",children:["שגיאה: ",m]}):(0,a.jsxs)("div",{className:"bg-gradient-to-br from-gray-50 to-gray-100 rounded-lg shadow-lg p-8",dir:"rtl",children:[(0,a.jsx)("div",{className:"flex flex-col gap-4 mb-8",children:(0,a.jsx)("div",{className:"flex justify-between items-center",children:(0,a.jsx)("h2",{className:"text-3xl font-bold text-gray-800",children:'יחידות צמ"ה'})})}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8",children:[(0,a.jsxs)("div",{className:"relative overflow-hidden bg-white rounded-2xl shadow-sm hover:shadow-xl \n                transition-all duration-300 cursor-pointer transform hover:-translate-y-1\n                ".concat("צפון"===u?"ring-2 ring-blue-500 shadow-lg":""),onClick:()=>g("צפון"===u?null:"צפון"),children:[(0,a.jsx)("div",{className:"absolute top-0 left-0 w-full h-1 bg-blue-500"}),(0,a.jsx)("div",{className:"p-6",children:(0,a.jsxs)("div",{className:"flex justify-between items-start",children:[(0,a.jsxs)("div",{className:"flex flex-col items-end",children:[(0,a.jsx)("h3",{className:"text-xl font-bold text-gray-800 mb-1",children:'יצ"מ צפון'}),(0,a.jsxs)("div",{className:"flex flex-col items-end gap-1",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("span",{className:"text-sm text-gray-500",children:"כלי רכב פעילים:"}),(0,a.jsx)("span",{className:"text-lg font-semibold text-blue-600",children:j["צפון"].count})]}),(0,a.jsxs)("div",{className:"flex items-center gap-4 text-sm",children:[(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[(0,a.jsx)("span",{className:"text-gray-500",children:"תפוס:"}),(0,a.jsx)("span",{className:"font-medium text-orange-600",children:(null===(e=j["צפון"].stats)||void 0===e?void 0:e.תפוס)||0})]}),(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[(0,a.jsx)("span",{className:"text-gray-500",children:"מגוייס:"}),(0,a.jsx)("span",{className:"font-medium text-green-600",children:(null===(s=j["צפון"].stats)||void 0===s?void 0:s.מגוייס)||0})]})]})]})]}),(0,a.jsx)("div",{className:"p-3 bg-gradient-to-br from-blue-500 to-blue-600 rounded-xl shadow-lg",children:(0,a.jsx)(D.A,{className:"h-6 w-6 text-white"})})]})})]}),(0,a.jsxs)("div",{className:"relative overflow-hidden bg-white rounded-2xl shadow-sm hover:shadow-xl \n            transition-all duration-300 cursor-pointer transform hover:-translate-y-1\n            ".concat("מרכז"===u?"ring-2 ring-emerald-500 shadow-lg":""),onClick:()=>g("מרכז"===u?null:"מרכז"),children:[(0,a.jsx)("div",{className:"absolute top-0 left-0 w-full h-1 bg-emerald-500"}),(0,a.jsx)("div",{className:"p-6",children:(0,a.jsxs)("div",{className:"flex justify-between items-start",children:[(0,a.jsxs)("div",{className:"flex flex-col items-end",children:[(0,a.jsx)("h3",{className:"text-xl font-bold text-gray-800 mb-1",children:'יצ"מ מרכז'}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("span",{className:"text-sm text-gray-500",children:"כלי רכב פעילים:"}),(0,a.jsx)("span",{className:"text-lg font-semibold text-blue-600",children:j["מרכז"].count})]}),(0,a.jsxs)("div",{className:"flex items-center gap-4 text-sm",children:[(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[(0,a.jsx)("span",{className:"text-gray-500",children:"תפוס:"}),(0,a.jsx)("span",{className:"font-medium text-orange-600",children:(null===(t=j["מרכז"].stats)||void 0===t?void 0:t.תפוס)||0})]}),(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[(0,a.jsx)("span",{className:"text-gray-500",children:"מגוייס:"}),(0,a.jsx)("span",{className:"font-medium text-green-600",children:(null===(i=j["מרכז"].stats)||void 0===i?void 0:i.מגוייס)||0})]})]})]}),(0,a.jsx)("div",{className:"p-3 bg-gradient-to-br from-emerald-500 to-emerald-600 rounded-xl shadow-lg",children:(0,a.jsx)(D.A,{className:"h-6 w-6 text-white"})})]})})]}),(0,a.jsxs)("div",{className:"relative overflow-hidden bg-white rounded-2xl shadow-sm hover:shadow-xl \n            transition-all duration-300 cursor-pointer transform hover:-translate-y-1\n            ".concat("דרום"===u?"ring-2 ring-emerald-500 shadow-lg":""),onClick:()=>g("דרום"===u?null:"דרום"),children:[(0,a.jsx)("div",{className:"absolute top-0 left-0 w-full h-1 bg-emerald-500"}),(0,a.jsx)("div",{className:"p-6",children:(0,a.jsxs)("div",{className:"flex justify-between items-start",children:[(0,a.jsxs)("div",{className:"flex flex-col items-end",children:[(0,a.jsx)("h3",{className:"text-xl font-bold text-gray-800 mb-1",children:'יצ"מ דרום'}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("span",{className:"text-sm text-gray-500",children:"כלי רכב פעילים:"}),(0,a.jsx)("span",{className:"text-lg font-semibold text-blue-600",children:j["דרום"].count})]}),(0,a.jsxs)("div",{className:"flex items-center gap-4 text-sm",children:[(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[(0,a.jsx)("span",{className:"text-gray-500",children:"תפוס:"}),(0,a.jsx)("span",{className:"font-medium text-orange-600",children:(null===(d=j["דרום"].stats)||void 0===d?void 0:d.תפוס)||0})]}),(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[(0,a.jsx)("span",{className:"text-gray-500",children:"מגוייס:"}),(0,a.jsx)("span",{className:"font-medium text-green-600",children:(null===(c=j["דרום"].stats)||void 0===c?void 0:c.מגוייס)||0})]})]})]}),(0,a.jsx)("div",{className:"p-3 bg-gradient-to-br from-violet-500 to-violet-600 rounded-xl shadow-lg",children:(0,a.jsx)(D.A,{className:"h-6 w-6 text-white"})})]})})]})]}),u&&(0,a.jsx)("div",{className:"mt-8 transition-all duration-300 animate-fade-in",children:(0,a.jsx)(L,{data:j[u].data,region:u})})]})}var K=t(32423),I=t(48251),z=t(18842),J=t(58581),_=t(94973),B=t(12800),M=t(66963),P=t(27112),T=t(90518),G=t(16161);function U(){let[e,s]=(0,l.useState)([]),[t,i]=(0,l.useState)(!0),[d,c]=(0,l.useState)("month"),[o,x]=(0,l.useState)(0),[m,u]=(0,l.useState)(0);(0,l.useEffect)(()=>{(async()=>{try{i(!0);let e=(0,n.KR)(r.O,"/recruited"),t=await (0,n.Jt)(e);if(t.exists()){let e;let a=t.val(),l=(Array.isArray(a)?a:Object.values(a)).filter(e=>"מגוייס"===e["סטטוס"]),r=new Date,n=new Date;switch(d){case"year":n.setFullYear(n.getFullYear()-4),e={year:"numeric"};break;case"month":n.setMonth(n.getMonth()-11),e={month:"2-digit",year:"numeric"};break;case"week":n.setDate(n.getDate()-77),e={month:"2-digit",day:"2-digit"};break;case"day":n.setDate(n.getDate()-29),e={month:"2-digit",day:"2-digit"}}let i={},c=new Date(n);for(;c<=r;)switch(i[new Intl.DateTimeFormat("he-IL",e).format(c)]=0,d){case"year":c.setFullYear(c.getFullYear()+1);break;case"month":c.setMonth(c.getMonth()+1);break;case"week":c.setDate(c.getDate()+7);break;case"day":c.setDate(c.getDate()+1)}l.forEach(s=>{let t=new Date(s["חותמת זמן"]);if(t>=n&&t<=r){let s=new Intl.DateTimeFormat("he-IL",e).format(t);i[s]=(i[s]||0)+1}});let o=Object.entries(i).map(e=>{let[s,t]=e;return{date:s,count:t}}).sort((e,s)=>e.date.localeCompare(s.date)),m=o.reduce((e,s)=>e+s.count,0),h=Math.floor(o.length/2),g=o.slice(0,h),j=o.slice(h),p=g.reduce((e,s)=>e+s.count,0),b=j.reduce((e,s)=>e+s.count,0);x(m),u(0===p?0:(b-p)/p*100),s(o)}}catch(e){console.error("Error fetching data:",e)}finally{i(!1)}})()},[d]);let g=(e,s)=>(0,a.jsx)("button",{onClick:()=>c(e),className:"px-4 py-2 rounded-lg transition-all ".concat(d===e?"bg-blue-500 text-white shadow-lg scale-105":"bg-white hover:bg-gray-50 text-gray-600 hover:text-gray-900 border"),children:s});return(0,a.jsxs)("div",{className:"bg-white rounded-2xl shadow-xl p-8 mt-8",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8",children:[(0,a.jsx)("div",{className:"bg-gradient-to-br from-blue-50 to-blue-100 p-6 rounded-xl",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-blue-600 text-sm font-medium",children:'סה"כ גיוסים'}),(0,a.jsx)("h3",{className:"text-2xl font-bold mt-1",children:o})]}),(0,a.jsx)("div",{className:"p-3 bg-blue-500 rounded-lg",children:(0,a.jsx)(K.A,{className:"h-6 w-6 text-white"})})]})}),(0,a.jsx)("div",{className:"bg-gradient-to-br from-emerald-50 to-emerald-100 p-6 rounded-xl",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-emerald-600 text-sm font-medium",children:"שינוי"}),(0,a.jsxs)("div",{className:"flex items-center gap-2 mt-1",children:[(0,a.jsxs)("h3",{className:"text-2xl font-bold",children:[Math.abs(m).toFixed(1),"%"]}),m>0?(0,a.jsx)(I.A,{className:"h-5 w-5 text-emerald-500"}):(0,a.jsx)(z.A,{className:"h-5 w-5 text-red-500"})]})]}),(0,a.jsx)("div",{className:"p-3 rounded-lg ".concat(m>0?"bg-emerald-500":"bg-red-500"),children:(0,a.jsx)(K.A,{className:"h-6 w-6 text-white"})})]})}),(0,a.jsxs)("div",{className:"flex flex-wrap gap-2 items-center justify-end",children:[g("year","שנתי"),g("month","חודשי"),g("week","שבועי"),g("day","יומי")]})]}),t?(0,a.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,a.jsx)(h.A,{className:"w-8 h-8 animate-spin text-blue-500"})}):(0,a.jsx)("div",{className:"h-[400px]",children:(0,a.jsx)(J.u,{width:"100%",height:"100%",children:(0,a.jsxs)(_.b,{data:e,margin:{top:20,right:30,left:20,bottom:60},children:[(0,a.jsx)("defs",{children:(0,a.jsxs)("linearGradient",{id:"colorCount",x1:"0",y1:"0",x2:"0",y2:"1",children:[(0,a.jsx)("stop",{offset:"5%",stopColor:"#3b82f6",stopOpacity:.2}),(0,a.jsx)("stop",{offset:"95%",stopColor:"#3b82f6",stopOpacity:0})]})}),(0,a.jsx)(B.W,{dataKey:"date",angle:45,textAnchor:"start",height:60,interval:0,tick:{fontSize:12}}),(0,a.jsx)(M.h,{}),(0,a.jsx)(P.m,{content:(0,a.jsx)(e=>{let{active:s,payload:t}=e;return s&&t&&t.length?(0,a.jsxs)("div",{className:"bg-white p-3 shadow-lg rounded-lg border",children:[(0,a.jsx)("p",{className:"text-sm font-medium",children:t[0].payload.date}),(0,a.jsxs)("p",{className:"text-blue-600 font-bold",children:[t[0].value," גיוסים"]})]}):null},{})}),(0,a.jsx)(T.G,{type:"monotone",dataKey:"count",stroke:"none",fill:"url(#colorCount)"}),(0,a.jsx)(G.N,{type:"monotone",dataKey:"count",stroke:"#3b82f6",strokeWidth:2,dot:{fill:"#3b82f6",strokeWidth:2},activeDot:{r:6,fill:"#3b82f6"}})]})})})]})}function V(){let[e,s]=(0,l.useState)([]),[t,r]=(0,l.useState)(!0),[n,i]=(0,l.useState)(null),[d,c]=(0,l.useState)(!1),[o,x]=(0,l.useState)(null);(0,l.useEffect)(()=>{m()},[]);let m=async()=>{try{let e=await fetch("https://geomai21-default-rtdb.firebaseio.com/owner/data_owner.json");if(!e.ok)throw Error("Failed to fetch owners data");let t=await e.json(),a=Object.entries(t).map(e=>{let[s,t]=e;return{id:s,...t}});s(a)}catch(e){i(e instanceof Error?e.message:"An error occurred")}finally{r(!1)}},h=async(e,s)=>{try{if(!(await fetch("https://geomai21-default-rtdb.firebaseio.com/owner/data_owner/".concat(e,".json"),{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)})).ok)throw Error("Failed to update owner");await m(),x(null)}catch(e){i(e instanceof Error?e.message:"Failed to update owner")}},u=e=>e&&e.toString().split(",").filter(e=>"*nan"!==e.trim()&&"nan"!==e.trim()&&"לא ידוע"!==e.trim()).map(e=>e.trim()).join(", ")||"לא ידוע";return t?(0,a.jsx)("div",{className:"flex justify-center items-center h-64",children:(0,a.jsx)("div",{className:"text-xl text-gray-600",children:"טוען נתונים..."})}):n?(0,a.jsx)("div",{className:"flex justify-center items-center h-64",children:(0,a.jsxs)("div",{className:"text-xl text-red-600",children:["שגיאה: ",n]})}):(0,a.jsxs)("div",{className:"w-full bg-white rounded-lg shadow-lg p-6",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,a.jsx)("h2",{className:"text-2xl font-bold",children:"ניהול בעלים"}),(0,a.jsx)("button",{onClick:()=>c(!d),className:"px-4 py-2 rounded-md ".concat(d?"bg-red-500 hover:bg-red-600 text-white":"bg-blue-500 hover:bg-blue-600 text-white"),children:d?"סיום עריכה":"מצב עריכה"})]}),(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)("table",{className:"w-full",children:[(0,a.jsx)("thead",{children:(0,a.jsxs)("tr",{className:"bg-gray-50",children:[(0,a.jsx)("th",{className:"p-3 text-right",children:"ציון בעלים"}),(0,a.jsx)("th",{className:"p-3 text-right",children:"אורך"}),(0,a.jsx)("th",{className:"p-3 text-right",children:"רוחב"}),(0,a.jsx)("th",{className:"p-3 text-right",children:"הערות בעלים"}),(0,a.jsx)("th",{className:"p-3 text-right",children:'ח"פ'}),(0,a.jsx)("th",{className:"p-3 text-right",children:"חתום"}),(0,a.jsx)("th",{className:"p-3 text-right",children:"טלפון בעלים"}),d&&(0,a.jsx)("th",{className:"p-3 text-right",children:"פעולות"})]})}),(0,a.jsx)("tbody",{children:e.map(e=>(0,a.jsxs)("tr",{className:"border-b",children:[(0,a.jsx)("td",{className:"p-3",children:e["ציון בעלים"]||"לא ידוע"}),(0,a.jsx)("td",{className:"p-3",children:e["אורך"]||0}),(0,a.jsx)("td",{className:"p-3",children:e["רוחב"]||0}),(0,a.jsx)("td",{className:"p-3",children:e["הערות בעלים"]||"לא ידוע"}),(0,a.jsx)("td",{className:"p-3",children:e["חפ"]||"לא ידוע"}),(0,a.jsx)("td",{className:"p-3",children:e["חתום"]?"✓":"✗"}),(0,a.jsx)("td",{className:"p-3",children:u(e["טלפון בעלים"])}),d&&(0,a.jsx)("td",{className:"p-3",children:(0,a.jsx)("button",{onClick:()=>x(e),className:"px-3 py-1 bg-gray-100 hover:bg-gray-200 rounded-md text-sm",children:"ערוך"})})]},e.id))})]})}),o&&(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center",children:(0,a.jsxs)("div",{className:"bg-white p-6 rounded-lg w-full max-w-2xl",children:[(0,a.jsx)("h3",{className:"text-xl font-bold mb-4",children:"עריכת בעלים"}),(0,a.jsxs)("form",{onSubmit:e=>{e.preventDefault();let s=new FormData(e.currentTarget),t={"ציון בעלים":s.get("name"),אורך:Number(s.get("longitude")),רוחב:Number(s.get("latitude")),"הערות בעלים":s.get("notes"),חפ:Number(s.get("companyId")),חתום:s.get("signed")?1:0,"טלפון בעלים":s.get("phone")};h(o.id,t)},children:[(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium mb-1",children:"ציון בעלים"}),(0,a.jsx)("input",{name:"name",defaultValue:o["ציון בעלים"],className:"w-full p-2 border rounded-md"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium mb-1",children:"אורך"}),(0,a.jsx)("input",{name:"longitude",type:"number",defaultValue:o["אורך"],className:"w-full p-2 border rounded-md"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium mb-1",children:"רוחב"}),(0,a.jsx)("input",{name:"latitude",type:"number",defaultValue:o["רוחב"],className:"w-full p-2 border rounded-md"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium mb-1",children:"הערות בעלים"}),(0,a.jsx)("input",{name:"notes",defaultValue:o["הערות בעלים"],className:"w-full p-2 border rounded-md"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium mb-1",children:'ח"פ'}),(0,a.jsx)("input",{name:"companyId",type:"number",defaultValue:o["חפ"],className:"w-full p-2 border rounded-md"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium mb-1",children:"טלפון בעלים"}),(0,a.jsx)("input",{name:"phone",defaultValue:o["טלפון בעלים"],className:"w-full p-2 border rounded-md"})]}),(0,a.jsx)("div",{className:"col-span-2",children:(0,a.jsxs)("label",{className:"flex items-center space-x-2",children:[(0,a.jsx)("input",{type:"checkbox",name:"signed",defaultChecked:!!o["חתום"],className:"w-4 h-4"}),(0,a.jsx)("span",{className:"text-sm font-medium",children:"חתום"})]})})]}),(0,a.jsxs)("div",{className:"flex justify-end space-x-2 mt-4",children:[(0,a.jsx)("button",{type:"submit",className:"px-4 py-2 bg-blue-500 text-white rounded-md hover:bg-blue-600",children:"שמור"}),(0,a.jsx)("button",{type:"button",onClick:()=>x(null),className:"px-4 py-2 bg-gray-100 rounded-md hover:bg-gray-200",children:"ביטול"})]})]})]})})]})}var W=t(22175),Y=t(90457),q=t(67732),Z=t(86354),H=t(394),Q=t(23021);let X=["#0088FE","#00C49F","#FFBB28","#FF8042","#8884d8","#82ca9d","#ffc658","#ff7300"];function $(){let[e,s]=(0,l.useState)([]),[t,i]=(0,l.useState)([]),[d,c]=(0,l.useState)(""),[o,x]=(0,l.useState)("pie"),[m,h]=(0,l.useState)([]);(0,l.useEffect)(()=>{u()},[]);let u=async()=>{try{let e=(0,n.KR)(r.O,"/data/data"),t=await (0,n.Jt)(e);if(t.exists()){let e=t.val(),a=Object.values(e);if(a.length>0){let e=a[0],t=Object.keys(e);i(t),c(t[0]),s(a)}}}catch(e){console.error("Error fetching data:",e)}},g=s=>{let t={};e.forEach(e=>{var a;let l=(null===(a=e[s])||void 0===a?void 0:a.toString())||"לא ידוע";t[l]=(t[l]||0)+1});let a=Object.entries(t).map(e=>{let[s,t]=e;return{name:s,value:t}});a.sort((e,s)=>s.value-e.value),a.length>8&&x("bar"),h(a)};return(0,l.useEffect)(()=>{d&&g(d)},[d,e]),(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-lg p-6",children:[(0,a.jsx)("h2",{className:"text-2xl font-bold mb-6 text-gray-800",children:"סטטיסטיקה"}),(0,a.jsxs)("div",{className:"flex gap-4 mb-6",children:[(0,a.jsxs)("select",{value:d,onChange:e=>c(e.target.value),className:"w-[180px] p-2 border rounded-md bg-white shadow-sm",dir:"rtl",children:[(0,a.jsx)("option",{value:"",children:"בחר עמודה"}),t.map(e=>(0,a.jsx)("option",{value:e,children:e},e))]}),(0,a.jsxs)("select",{value:o,onChange:e=>x(e.target.value),className:"w-[180px] p-2 border rounded-md bg-white shadow-sm",dir:"rtl",children:[(0,a.jsx)("option",{value:"pie",children:"תרשים עוגה"}),(0,a.jsx)("option",{value:"bar",children:"תרשים עמודות"})]})]}),m.length>0&&(0,a.jsxs)("div",{className:"flex gap-6",children:[(0,a.jsx)("div",{className:"flex-1 border rounded-lg p-4 bg-white",children:"pie"===o?(0,a.jsx)(J.u,{width:"100%",height:400,children:(0,a.jsxs)(W.r,{children:[(0,a.jsx)(Y.F,{data:m,cx:"50%",cy:"50%",labelLine:!1,label:e=>{let{name:s,percent:t}=e;return"".concat(s," (").concat((100*t).toFixed(0),"%)")},outerRadius:150,fill:"#8884d8",dataKey:"value",children:m.map((e,s)=>(0,a.jsx)(q.f,{fill:X[s%X.length]},"cell-".concat(s)))}),(0,a.jsx)(P.m,{}),(0,a.jsx)(Z.s,{})]})}):(0,a.jsx)(J.u,{width:"100%",height:400,children:(0,a.jsxs)(H.E,{data:m,children:[(0,a.jsx)(B.W,{dataKey:"name",angle:-45,textAnchor:"end",height:100,interval:0}),(0,a.jsx)(M.h,{}),(0,a.jsx)(P.m,{}),(0,a.jsx)(Z.s,{}),(0,a.jsx)(Q.y,{dataKey:"value",fill:"#8884d8",children:m.map((e,s)=>(0,a.jsx)(q.f,{fill:X[s%X.length]},"cell-".concat(s)))})]})})}),(0,a.jsx)("div",{className:"w-80",children:(()=>{let e=m.reduce((e,s)=>e+s.value,0);return(0,a.jsx)("div",{className:"bg-white rounded-lg shadow p-4 h-[400px] overflow-y-auto",children:(0,a.jsxs)("table",{className:"w-full text-right",children:[(0,a.jsx)("thead",{className:"sticky top-0 bg-white border-b",children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"p-2",children:"ערך"}),(0,a.jsx)("th",{className:"p-2",children:"כמות"}),(0,a.jsx)("th",{className:"p-2",children:"אחוז"})]})}),(0,a.jsx)("tbody",{children:m.map((s,t)=>(0,a.jsxs)("tr",{className:"border-b hover:bg-gray-50",children:[(0,a.jsx)("td",{className:"p-2 font-medium",children:s.name}),(0,a.jsx)("td",{className:"p-2",children:s.value}),(0,a.jsxs)("td",{className:"p-2",children:[(s.value/e*100).toFixed(1),"%"]})]},t))})]})})})()})]})]}),(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-lg p-6",children:[(0,a.jsx)("h2",{className:"text-2xl font-bold mb-6 text-gray-800",children:"סיכום נתונים"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,a.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold mb-2 text-gray-700",children:'סה"כ רשומות'}),(0,a.jsx)("p",{className:"text-3xl font-bold text-gray-900",children:e.length})]}),d&&(0,a.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold mb-2 text-gray-700",children:"ערכים ייחודיים"}),(0,a.jsx)("p",{className:"text-3xl font-bold text-gray-900",children:m.length})]})]})]})]})}function ee(e){let{initialSearchTerm:s}=e,[t,i]=(0,l.useState)(s),[d,c]=(0,l.useState)([]),[o,x]=(0,l.useState)([]),[m,g]=(0,l.useState)(!1),[j,p]=(0,l.useState)(null),[b,f]=(0,l.useState)(null);(0,l.useEffect)(()=>{v()},[]),(0,l.useEffect)(()=>{s&&o.length>0&&N(s)},[s,o]);let v=async()=>{g(!0);try{let e=(0,n.KR)(r.O,"/data/data"),s=await (0,n.Jt)(e);if(s.exists()){let e=Object.values(s.val());x(e)}}catch(e){p("Failed to fetch data"),console.error("Error fetching data:",e)}g(!1)},N=e=>{let s=String(e||"").trim();if(!s){c([]);return}c(o.filter(e=>String(e.רישוי||"").includes(s))),f(null)};return(0,l.useEffect)(()=>{let e=setTimeout(()=>{N(t)},300);return()=>clearTimeout(e)},[t]),(0,a.jsxs)("div",{className:"max-w-4xl mx-auto",children:[(0,a.jsx)("div",{className:"bg-white rounded-lg shadow-lg p-6 mb-6",children:(0,a.jsx)("form",{onSubmit:e=>{e.preventDefault(),N(t)},children:(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("input",{type:"text",value:t,onChange:e=>i(e.target.value),placeholder:"הקלד מספר רישוי...",className:"w-full px-4 py-3 pr-12 text-lg border rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-all",dir:"rtl"}),(0,a.jsx)("div",{className:"absolute left-3 top-1/2 transform -translate-y-1/2",children:m?(0,a.jsx)(h.A,{className:"h-6 w-6 text-gray-400 animate-spin"}):(0,a.jsx)(u.A,{className:"h-6 w-6 text-gray-400"})})]})})}),j?(0,a.jsx)("div",{className:"bg-red-50 text-red-600 p-4 rounded-lg text-center",children:j}):d.length>0?(0,a.jsx)("div",{className:"space-y-4",children:d.map((e,s)=>(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow hover:shadow-md transition-all duration-200",children:[(0,a.jsxs)("div",{className:"p-4 flex justify-between items-center cursor-pointer",onClick:()=>f(b===s?null:s),children:[(0,a.jsx)("div",{className:"flex items-center gap-4",children:(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-sm text-gray-500",children:"מספר רישוי"}),(0,a.jsx)("div",{className:"font-semibold text-lg",children:e.רישוי})]})}),b===s?(0,a.jsx)(y.A,{className:"h-5 w-5 text-gray-400"}):(0,a.jsx)(w.A,{className:"h-5 w-5 text-gray-400"})]}),b===s&&(0,a.jsx)("div",{className:"px-4 pb-4 border-t",children:(0,a.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4 pt-4",children:Object.entries(e).map(e=>{let[s,t]=e;return"רישוי"!==s&&t?(0,a.jsxs)("div",{className:"bg-gray-50 p-3 rounded-lg",children:[(0,a.jsx)("div",{className:"text-sm text-gray-500",children:s}),(0,a.jsx)("div",{className:"font-medium",children:String(t)})]},s):null})})})]},s))}):t?(0,a.jsxs)("div",{className:"bg-gray-50 text-gray-600 p-8 rounded-lg text-center",children:['לא נמצאו תוצאות עבור "',t,'"']}):null]})}function es(e){let{isOpen:s,onClose:t}=e,[r,n]=(0,l.useState)({name:"",phone:"",message:""});return s?(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",children:(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-md relative",onClick:e=>e.stopPropagation(),children:[(0,a.jsx)("button",{onClick:t,className:"absolute left-4 top-4 text-gray-500 hover:text-gray-700 transition-colors",children:(0,a.jsx)(o.A,{className:"h-6 w-6"})}),(0,a.jsxs)("div",{className:"p-6 border-b text-right",children:[(0,a.jsx)("h2",{className:"text-2xl font-bold text-gray-800",children:"יצירת קשר"}),(0,a.jsx)("p",{className:"text-gray-600 mt-1",children:"אנא מלא את הפרטים ונחזור אליך בהקדם"})]}),(0,a.jsxs)("form",{onSubmit:e=>{e.preventDefault();let s="\n      שם: ".concat(r.name,"\n      טלפון: ").concat(r.phone,"\n      הודעה: ").concat(r.message,"\n    "),a='mailto:yatzahamal@gmail.com?subject=פנייה חדשה ממערכת צמ"ה&body='.concat(encodeURIComponent(s));window.location.href=a,n({name:"",phone:"",message:""}),t()},className:"p-6 space-y-4",dir:"rtl",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700 mb-1",children:"שם מלא"}),(0,a.jsx)("input",{type:"text",id:"name",required:!0,className:"w-full p-2 border rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",value:r.name,onChange:e=>n({...r,name:e.target.value})})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"phone",className:"block text-sm font-medium text-gray-700 mb-1",children:"טלפון"}),(0,a.jsx)("input",{type:"tel",id:"phone",required:!0,className:"w-full p-2 border rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",value:r.phone,onChange:e=>n({...r,phone:e.target.value})})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"message",className:"block text-sm font-medium text-gray-700 mb-1",children:"הודעה"}),(0,a.jsx)("textarea",{id:"message",required:!0,rows:4,className:"w-full p-2 border rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",value:r.message,onChange:e=>n({...r,message:e.target.value})})]}),(0,a.jsx)("div",{className:"pt-4",children:(0,a.jsx)("button",{type:"submit",className:"w-full bg-blue-600 text-white py-2 px-4 rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-colors",children:"שלח"})})]})]})}):null}var et=t(87364),ea=t(25284),el=t(88168);function er(e){let{isOpen:s,onClose:t}=e,[r,n]=(0,l.useState)("docs"),[i,d]=(0,l.useState)(null);return s?(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 overflow-auto",children:(0,a.jsxs)("div",{className:"min-h-screen bg-gray-50 md:mr-auto md:w-2/3 lg:w-1/2 shadow-2xl animate-slide-left",children:[(0,a.jsx)("div",{className:"bg-white border-b sticky top-0 z-10",children:(0,a.jsx)("div",{className:"container mx-auto p-4",children:(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("button",{onClick:t,className:"p-2 hover:bg-gray-100 rounded-full transition-colors",children:(0,a.jsx)(et.A,{className:"h-6 w-6"})}),(0,a.jsxs)("div",{className:"flex gap-4",children:[(0,a.jsxs)("button",{onClick:()=>n("docs"),className:"flex items-center gap-2 px-4 py-2 rounded-md transition-colors ".concat("docs"===r?"bg-blue-50 text-blue-600":"text-gray-600 hover:bg-gray-50"),children:[(0,a.jsx)(ea.A,{className:"h-5 w-5"}),(0,a.jsx)("span",{children:"תיעוד"})]}),(0,a.jsxs)("button",{onClick:()=>n("news"),className:"flex items-center gap-2 px-4 py-2 rounded-md transition-colors ".concat("news"===r?"bg-blue-50 text-blue-600":"text-gray-600 hover:bg-gray-50"),children:[(0,a.jsx)(el.A,{className:"h-5 w-5"}),(0,a.jsx)("span",{children:"חדשות"})]})]})]})})}),(0,a.jsx)("div",{className:"container mx-auto p-4 md:p-6",children:"docs"===r?(0,a.jsxs)("div",{className:"space-y-6",dir:"rtl",children:[(0,a.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"תיעוד המערכת"}),(0,a.jsx)("p",{className:"text-gray-600 text-lg",children:'ברוכים הבאים למערכת ניהול כלי צמ"ה. כאן תוכלו למצוא את כל המידע הנחוץ לשימוש במערכת.'}),(0,a.jsx)("div",{className:"space-y-4 mt-8",children:[{id:"intro",title:"מבוא",content:"מערכת זו נבנתה לאגד את נתוני הצמה והמלגזות, לאתר לסנן ולעקוב אחרי מיקומן ומצבן."},{id:"search",title:"חיפוש",content:"ניתן לחפש לפי מספר רישוי, ולקבל את כל המידע הרלוונטי על הכלי המבוקש."},{id:"map",title:"מפה",content:"המפה מציגה את מיקום כל הכלים על גבי מפה אינטראקטיבית."},{id:"stats",title:"סטטיסטיקות",content:"הצגת נתונים סטטיסטיים על הכלים, כולל גרפים ותרשימים."}].map(e=>(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-sm",children:[(0,a.jsxs)("button",{onClick:()=>d(i===e.id?null:e.id),className:"w-full p-4 flex justify-between items-center hover:bg-gray-50 transition-colors",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold text-gray-800",children:e.title}),(0,a.jsx)(w.A,{className:"h-5 w-5 text-gray-400 transition-transform ".concat(i===e.id?"transform rotate-180":"")})]}),i===e.id&&(0,a.jsx)("div",{className:"p-4 pt-0 border-t",children:(0,a.jsx)("p",{className:"text-gray-600",children:e.content})})]},e.id))})]}):(0,a.jsxs)("div",{className:"space-y-6",dir:"rtl",children:[(0,a.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"חדשות ועדכונים"}),(0,a.jsx)("div",{className:"space-y-4",children:[{date:"10.11.2024",title:"עדכון מערכת חדש",content:"שודרגה יכולת החיפוש במערכת. כעת ניתן לחפש במהירות ובקלות רבה יותר.",tag:"חדש"},{date:"09.11.2024",title:"עדכון נתונים",content:"עודכנו נתוני המערכת עם המידע העדכני ביותר מהשטח.",tag:"עדכון"}].map((e,s)=>(0,a.jsx)("div",{className:"bg-white rounded-lg shadow-sm overflow-hidden",children:(0,a.jsxs)("div",{className:"p-6",children:[(0,a.jsxs)("div",{className:"flex justify-between items-start mb-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-sm text-gray-500",children:e.date}),(0,a.jsx)("h3",{className:"text-xl font-semibold text-gray-800 mt-1",children:e.title})]}),(0,a.jsx)("span",{className:"px-3 py-1 bg-blue-100 text-blue-700 rounded-full text-sm",children:e.tag})]}),(0,a.jsx)("p",{className:"text-gray-600",children:e.content})]})},s))})]})})]})}):null}var en=t(81476),ei=t(44857),ed=t(93518);let ec=[{id:"vehicles",name:"כלי רכב",path:"/data/data",type:"firebase"},{id:"owners",name:"בעלים",path:"/owner/data_owner",type:"firebase"},{id:"recruited",name:"מגוייסים",path:"/recruited",type:"firebase"}],eo=()=>{let[e,s]=(0,l.useState)(ec[0]),[t,i]=(0,l.useState)([]),[d,c]=(0,l.useState)([]),[x,h]=(0,l.useState)({}),[g,j]=(0,l.useState)({from:null,to:null}),[p,b]=(0,l.useState)({}),[f,v]=(0,l.useState)(""),[N,y]=(0,l.useState)(1),[k,S]=(0,l.useState)({}),[A,E]=(0,l.useState)(!1),[O,D]=(0,l.useState)(null),F=async e=>{let s=(0,n.KR)(r.O,e),t=await (0,n.Jt)(s);return t.exists()?Object.values(t.val()):[]};(0,l.useEffect)(()=>{(async()=>{E(!0),D(null);try{let s=[];"firebase"===e.type&&(s=await F(e.path)),i(s),c(s),h({}),j({from:null,to:null}),y(1);let t={};s.length>0&&Object.keys(s[0]).forEach(e=>{let a=[...new Set(s.map(s=>s[e]))].filter(Boolean);t[e]=a}),b(t)}catch(e){D(e instanceof Error?e.message:"An error occurred"),console.error("Error fetching data:",e)}finally{E(!1)}})()},[e]),(0,l.useEffect)(()=>{let e=[...t];Object.entries(x).forEach(s=>{let[t,a]=s;a&&a.length>0&&(e=e.filter(e=>a.includes(e[t]||"")))}),g.from&&g.to&&(e=e.filter(e=>{if(!e.תאריך)return!1;let s=new Date(e.תאריך);return g.from&&g.to&&s>=g.from&&s<=g.to})),c(e),y(1)},[x,g,t]);let L=(e,s)=>{h(t=>({...t,[e]:s}))},R=e=>{let s={...x};delete s[e],h(s)},I=(N-1)*10,z=Math.ceil(d.length/10),J=d.slice(I,I+10);return(0,l.useEffect)(()=>{let e=e=>{f&&!e.target.closest(".popover-container")&&v("")};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[f]),(0,a.jsxs)("div",{className:"space-y-6",dir:"rtl",children:[(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-4",children:[(0,a.jsx)(en.A,{className:"h-6 w-6 text-gray-600"}),(0,a.jsx)("h2",{className:"text-xl font-bold",children:"בחר מאגר נתונים"})]}),(0,a.jsx)("div",{className:"flex flex-wrap gap-2",children:ec.map(t=>(0,a.jsx)("button",{onClick:()=>s(t),className:"px-4 py-2 rounded-md text-sm font-medium transition-colors\n                ".concat(e.id===t.id?"bg-blue-100 text-blue-800 border-2 border-blue-300":"bg-gray-100 text-gray-700 border border-gray-300 hover:bg-gray-200"),children:t.name},t.id))})]}),A&&(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6 text-center",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-gray-900 mx-auto"}),(0,a.jsx)("p",{className:"mt-2 text-gray-600",children:"טוען נתונים..."})]}),O&&(0,a.jsx)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 text-red-700",children:(0,a.jsxs)("p",{children:["שגיאה בטעינת הנתונים: ",O]})}),!A&&!O&&t.length>0&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(C.A,{className:"h-6 w-6"}),(0,a.jsx)("h2",{className:"text-xl font-bold",children:"מסננים מתקדמים"})]}),(0,a.jsxs)("button",{onClick:()=>{if(0===d.length)return;let s=new Blob([[Object.keys(d[0]).join(","),...d.map(e=>Object.values(e).join(","))].join("\n")],{type:"text/csv"}),t=window.URL.createObjectURL(s),a=document.createElement("a");a.href=t,a.download="".concat(e.name,"_data.csv"),a.click(),window.URL.revokeObjectURL(t)},className:"flex items-center gap-2 px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:[(0,a.jsx)(ei.A,{className:"h-4 w-4"}),"ייצוא לאקסל"]})]}),(0,a.jsxs)("div",{className:"flex flex-wrap gap-2 mb-4",children:[Object.entries(x).map(e=>{let[s,t]=e;return t.map(e=>(0,a.jsxs)("span",{className:"inline-flex items-center gap-1 px-3 py-1 rounded-full text-sm bg-blue-100 text-blue-800",children:[s,": ",e,(0,a.jsx)(o.A,{className:"h-3 w-3 cursor-pointer hover:text-blue-600",onClick:()=>{let t=x[s].filter(s=>s!==e);0===t.length?R(s):L(s,t)}})]},"".concat(s,"-").concat(e)))}),g.from&&g.to&&(0,a.jsxs)("span",{className:"inline-flex items-center gap-1 px-3 py-1 rounded-full text-sm bg-blue-100 text-blue-800",children:["".concat(g.from.toLocaleDateString()," - ").concat(g.to.toLocaleDateString()),(0,a.jsx)(o.A,{className:"h-3 w-3 cursor-pointer hover:text-blue-600",onClick:()=>j({from:null,to:null})})]})]}),(0,a.jsxs)("div",{className:"flex flex-wrap gap-2",children:[(0,a.jsxs)("div",{className:"relative popover-container",children:[(0,a.jsx)("button",{onClick:()=>v("date"===f?"":"date"),className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(K.A,{className:"h-4 w-4"}),(0,a.jsx)("span",{children:"טווח תאריכים"})]})}),"date"===f&&(0,a.jsxs)("div",{className:"absolute mt-2 w-72 bg-white rounded-md shadow-lg z-10 p-4",children:[(0,a.jsx)("input",{type:"date",className:"w-full mb-2 p-2 border rounded",onChange:e=>j(s=>({...s,from:new Date(e.target.value)}))}),(0,a.jsx)("input",{type:"date",className:"w-full p-2 border rounded",onChange:e=>j(s=>({...s,to:new Date(e.target.value)}))})]})]}),Object.entries(p).map(e=>{let[s,t]=e;return(0,a.jsxs)("div",{className:"relative popover-container",children:[(0,a.jsx)("button",{onClick:()=>v(f===s?"":s),className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[s,(0,a.jsx)(w.A,{className:"h-4 w-4"})]})}),f===s&&(0,a.jsxs)("div",{className:"absolute mt-2 w-64 bg-white rounded-md shadow-lg z-10",children:[(0,a.jsx)("div",{className:"p-2 border-b",children:(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(u.A,{className:"absolute left-2 top-2.5 h-4 w-4 text-gray-400"}),(0,a.jsx)("input",{type:"text",placeholder:"חיפוש...",className:"w-full pl-8 pr-2 py-2 text-sm border rounded",value:k[s]||"",onChange:e=>S(t=>({...t,[s]:e.target.value}))})]})}),(0,a.jsx)("div",{className:"max-h-48 overflow-y-auto p-2",children:t.filter(e=>!k[s]||e.toString().toLowerCase().includes(k[s].toLowerCase())).map(e=>{var t;return(0,a.jsxs)("label",{className:"flex items-center gap-2 px-2 py-1 hover:bg-gray-100 rounded cursor-pointer",children:[(0,a.jsx)("input",{type:"checkbox",className:"rounded text-indigo-600",checked:null===(t=x[s])||void 0===t?void 0:t.includes(e),onChange:t=>{let a=x[s]||[];t.target.checked?L(s,[...a,e]):L(s,a.filter(s=>s!==e))}}),(0,a.jsx)("span",{className:"text-sm",children:e})]},e)})})]})]},s)})]})]}),(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-md overflow-hidden",children:[(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,a.jsx)("thead",{className:"bg-gray-50",children:(0,a.jsx)("tr",{children:Object.keys(t[0]||{}).map(e=>(0,a.jsx)("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:e},e))})}),(0,a.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:J.length>0?J.map((e,s)=>(0,a.jsx)("tr",{className:"hover:bg-gray-50",children:Object.values(e).map((e,s)=>(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e},s))},s)):(0,a.jsx)("tr",{children:(0,a.jsx)("td",{colSpan:Object.keys(t[0]||{}).length,className:"px-6 py-8 text-center text-gray-500",children:"לא נמצאו תוצאות מתאימות לחיפוש"})})})]})}),(0,a.jsxs)("div",{className:"bg-white px-4 py-3 flex items-center justify-between border-t border-gray-200 sm:px-6",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("button",{onClick:()=>y(N-1),disabled:1===N,className:"disabled:opacity-50 disabled:cursor-not-allowed p-2 hover:bg-gray-100 rounded",children:(0,a.jsx)(m.A,{className:"h-5 w-5"})}),(0,a.jsxs)("span",{className:"text-sm text-gray-700",children:["עמוד ",N," מתוך ",z]}),(0,a.jsx)("button",{onClick:()=>y(N+1),disabled:N===z,className:"disabled:opacity-50 disabled:cursor-not-allowed p-2 hover:bg-gray-100 rounded",children:(0,a.jsx)(ed.A,{className:"h-5 w-5"})})]}),(0,a.jsxs)("div",{className:"text-sm text-gray-700",children:['סה"כ: ',d.length," רשומות"]})]})]})]}),!A&&!O&&0===t.length&&(0,a.jsx)("div",{className:"bg-white rounded-lg shadow-md p-6 text-center",children:(0,a.jsx)("p",{className:"text-gray-500",children:"לא נמצאו נתונים במאגר זה"})})]})};var ex=t(26336),em=t(61594),eh=t(48291),eu=t(2746);let eg=e=>{let{isOpen:s,onClose:t}=e,{user:i}=(0,k.A)(),[d,x]=(0,l.useState)(null),[m,h]=(0,l.useState)(null),u=async()=>{try{x("database");let e=(0,n.KR)(r.O,"/data/data"),s=await (0,n.Jt)(e);s.exists()?h({type:"success",message:"בסיס הנתונים תקין ומכיל "+Object.keys(s.val()).length+" רשומות"}):h({type:"error",message:"בסיס הנתונים ריק"})}catch(e){h({type:"error",message:"שגיאה בבדיקת בסיס הנתונים"})}finally{x(null)}},g=async()=>{if(confirm("האם אתה בטוח שברצונך לבטל את כל המרותקים?"))try{x("retention");let e=(0,n.KR)(r.O,"/data/data"),s=await (0,n.Jt)(e);if(s.exists()){let e={};Object.entries(s.val()).forEach(s=>{let[t,a]=s;"מרותק"===a.סטטוס&&(e["/data/data/".concat(t,"/סטטוס")]="לא פעיל")}),await (0,n.yo)((0,n.KR)(r.O),e),h({type:"success",message:"כל המרותקים בוטלו בהצלחה"})}}catch(e){h({type:"error",message:"שגיאה בביטול המרותקים"})}finally{x(null)}},j=async()=>{try{x("score"),h({type:"success",message:"הציון נקבע בהצלחה"})}catch(e){h({type:"error",message:"שגיאה בקביעת הציון"})}finally{x(null)}};return s?(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center",children:(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-md relative",dir:"rtl",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between p-4 border-b",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(c.A,{className:"h-6 w-6 text-gray-600"}),(0,a.jsx)("h2",{className:"text-xl font-bold",children:"הגדרות מערכת"})]}),(0,a.jsx)("button",{onClick:t,className:"p-1 hover:bg-gray-100 rounded-full transition-colors",children:(0,a.jsx)(o.A,{className:"h-5 w-5 text-gray-500"})})]}),m&&(0,a.jsxs)("div",{className:"mx-4 mt-4 p-3 rounded-lg flex items-center gap-2 ".concat("success"===m.type?"bg-green-50 text-green-700":"bg-red-50 text-red-700"),children:["success"===m.type?(0,a.jsx)(ex.A,{className:"h-5 w-5 flex-shrink-0"}):(0,a.jsx)(em.A,{className:"h-5 w-5 flex-shrink-0"}),(0,a.jsx)("p",{children:m.message})]}),(0,a.jsxs)("div",{className:"p-4 space-y-3",children:[(0,a.jsxs)("button",{onClick:g,disabled:"retention"===d,className:"w-full flex items-center gap-3 p-4 rounded-lg border border-gray-200 hover:bg-gray-50 transition-colors disabled:opacity-50",children:[(0,a.jsx)(eh.A,{className:"h-6 w-6 text-red-500"}),(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsx)("div",{className:"font-medium",children:"ביטול מרותקים"}),(0,a.jsx)("div",{className:"text-sm text-gray-500",children:"ביטול כל המרותקים במערכת"})]}),"retention"===d&&(0,a.jsx)("div",{className:"mr-auto",children:(0,a.jsx)("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-gray-900"})})]}),(0,a.jsxs)("button",{onClick:j,disabled:"score"===d,className:"w-full flex items-center gap-3 p-4 rounded-lg border border-gray-200 hover:bg-gray-50 transition-colors disabled:opacity-50",children:[(0,a.jsx)(eu.A,{className:"h-6 w-6 text-yellow-500"}),(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsx)("div",{className:"font-medium",children:"קביעת ציון"}),(0,a.jsx)("div",{className:"text-sm text-gray-500",children:"הגדרת ציון למערכת"})]}),"score"===d&&(0,a.jsx)("div",{className:"mr-auto",children:(0,a.jsx)("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-gray-900"})})]}),(0,a.jsxs)("button",{onClick:u,disabled:"database"===d,className:"w-full flex items-center gap-3 p-4 rounded-lg border border-gray-200 hover:bg-gray-50 transition-colors disabled:opacity-50",children:[(0,a.jsx)(en.A,{className:"h-6 w-6 text-blue-500"}),(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsx)("div",{className:"font-medium",children:"בדיקת בסיס נתונים"}),(0,a.jsx)("div",{className:"text-sm text-gray-500",children:"בדיקת תקינות ומספר רשומות"})]}),"database"===d&&(0,a.jsx)("div",{className:"mr-auto",children:(0,a.jsx)("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-gray-900"})})]})]})]})}):null};function ej(){let[e,s]=(0,l.useState)("main"),[t,v]=(0,l.useState)(!1),[N,y]=(0,l.useState)(!1),[w,k]=(0,l.useState)(!1),[A,O]=(0,l.useState)(""),[D,F]=(0,l.useState)(!1),[L,K]=(0,l.useState)([]),[I,z]=(0,l.useState)([]),[J,_]=(0,l.useState)(!1),B=(0,l.useRef)(null),[M,P]=(0,l.useState)(!1);(0,l.useEffect)(()=>{(async()=>{try{let e=(0,n.KR)(r.O,"/data/data"),s=await (0,n.Jt)(e);if(s.exists()){let e=Object.values(s.val());z(e)}}catch(e){console.error("Error fetching data:",e)}})()},[]),(0,l.useEffect)(()=>{let e=e=>{B.current&&!B.current.contains(e.target)&&_(!1)};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]),(0,l.useEffect)(()=>{A?(console.log("Searching for:",A),F(!0),K(I.filter(e=>{var s;return((null===(s=e.רישוי)||void 0===s?void 0:s.toString())||"").includes(A)}).slice(0,5)),_(!0),F(!1)):(K([]),_(!1))},[A,I]);let T=()=>(0,a.jsx)("div",{className:"bg-white shadow-md sticky top-0 z-40",children:(0,a.jsxs)("div",{className:"container mx-auto px-4",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center h-16",children:[(0,a.jsx)("div",{onClick:()=>s("main"),className:"cursor-pointer flex items-center gap-2 text-gray-800 hover:text-blue-600 transition-colors",children:(0,a.jsx)("span",{className:"font-bold text-xl",children:'צהל - בלמ"ס'})}),(0,a.jsxs)("div",{className:"hidden md:flex items-center gap-6",children:[(0,a.jsxs)("button",{onClick:()=>y(!0),className:"flex items-center gap-2 px-4 py-2 text-gray-600 hover:text-blue-600 hover:bg-gray-50 rounded-md transition-all",children:[(0,a.jsx)(i.A,{className:"h-5 w-5"}),(0,a.jsx)("span",{children:"תיעוד"})]}),(0,a.jsxs)("button",{onClick:()=>v(!0),className:"flex items-center gap-2 px-4 py-2 text-gray-600 hover:text-blue-600 hover:bg-gray-50 rounded-md transition-all",children:[(0,a.jsx)(d.A,{className:"h-5 w-5"}),(0,a.jsx)("span",{children:"יצירת קשר"})]}),(0,a.jsxs)("button",{onClick:()=>P(!0),className:"flex items-center gap-2 px-4 py-2 text-gray-600 hover:text-blue-600 hover:bg-gray-50 rounded-md transition-all",children:[(0,a.jsx)(c.A,{className:"h-5 w-5"}),(0,a.jsx)("span",{children:"הגדרות"})]})]}),(0,a.jsx)("button",{onClick:()=>k(!w),className:"md:hidden p-2 text-gray-600 hover:text-blue-600",children:w?(0,a.jsx)(o.A,{className:"h-6 w-6"}):(0,a.jsx)(x.A,{className:"h-6 w-6"})})]}),w&&(0,a.jsx)("div",{className:"md:hidden py-4 border-t",children:(0,a.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,a.jsxs)("button",{onClick:()=>{y(!0),k(!1)},className:"flex items-center gap-2 px-4 py-2 text-gray-600 hover:text-blue-600 hover:bg-gray-50 rounded-md transition-all",children:[(0,a.jsx)(i.A,{className:"h-5 w-5"}),(0,a.jsx)("span",{children:"תיעוד"})]}),(0,a.jsxs)("button",{onClick:()=>{v(!0),k(!1)},className:"flex items-center gap-2 px-4 py-2 text-gray-600 hover:text-blue-600 hover:bg-gray-50 rounded-md transition-all",children:[(0,a.jsx)(d.A,{className:"h-5 w-5"}),(0,a.jsx)("span",{children:"יצירת קשר"})]}),(0,a.jsxs)("button",{className:"flex items-center gap-2 px-4 py-2 text-gray-600 hover:text-blue-600 hover:bg-gray-50 rounded-md transition-all",children:[(0,a.jsx)(c.A,{className:"h-5 w-5"}),(0,a.jsx)("span",{children:"הגדרות"})]})]})})]})});return"main"!==e?(0,a.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 to-gray-100",children:[(0,a.jsx)(T,{}),(0,a.jsxs)("div",{className:"p-4 md:p-6",children:[(0,a.jsx)("button",{onClick:()=>s("main"),className:"mb-6 text-blue-600 hover:text-blue-800 flex items-center gap-2",children:"← חזור למסך הראשי"}),"database"===e&&(0,a.jsx)(S,{}),"map"===e&&(0,a.jsx)(E,{}),"yazam"===e&&(0,a.jsx)(R,{}),"owners"===e&&(0,a.jsx)(V,{}),"stats"===e&&(0,a.jsx)($,{}),"search"===e&&(0,a.jsx)(ee,{initialSearchTerm:A}),"filters"===e&&(0,a.jsx)(eo,{})]})]}):(0,a.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 to-gray-100",children:[(0,a.jsx)(T,{}),(0,a.jsx)(eg,{isOpen:M,onClose:()=>P(!1)}),(0,a.jsx)(es,{isOpen:t,onClose:()=>v(!1)}),(0,a.jsx)(er,{isOpen:N,onClose:()=>y(!1)}),(0,a.jsxs)("main",{className:"container mx-auto px-4 py-8 md:py-16",children:[(0,a.jsxs)("div",{className:"text-center mb-8",children:[(0,a.jsx)("h1",{className:"text-3xl md:text-5xl font-bold text-gray-800 mb-8",children:'מערכת ניהול כלי צמ"ה'}),(0,a.jsxs)("div",{className:"max-w-2xl mx-auto mb-8 relative",ref:B,children:[(0,a.jsx)("form",{onSubmit:e=>{e.preventDefault(),A&&(s("search"),_(!1))},children:(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("input",{type:"text",value:A,onChange:e=>O(e.target.value),onFocus:()=>_(!0),placeholder:"הקלד מספר רישוי...",className:"w-full px-4 py-4 pr-12 text-lg border rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all shadow-lg",dir:"rtl"}),(0,a.jsx)("div",{className:"absolute left-3 top-1/2 transform -translate-y-1/2",children:D?(0,a.jsx)(h.A,{className:"h-6 w-6 text-gray-400 animate-spin"}):(0,a.jsx)(u.A,{className:"h-6 w-6 text-gray-400"})})]})}),J&&(0,a.jsx)(()=>(0,a.jsxs)("div",{className:"absolute top-full left-0 right-0 mt-2 bg-white rounded-lg shadow-xl border border-gray-200 max-h-80 overflow-y-auto z-50",children:[L.map((e,t)=>(0,a.jsxs)("div",{className:"p-4 hover:bg-gray-50 cursor-pointer border-b last:border-b-0 flex items-center justify-between",onClick:()=>{O(e.רישוי),s("search"),_(!1)},children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"font-medium text-lg",children:e.רישוי}),(0,a.jsxs)("div",{className:"text-sm text-gray-500 mt-1",children:[e.סוג||"לא צוין סוג"," • ",e.יצרן||"לא צוין יצרן"]})]}),(0,a.jsx)(m.A,{className:"h-5 w-5 text-gray-400"})]},t)),0===L.length&&A&&(0,a.jsxs)("div",{className:"p-4 text-gray-500 text-center",children:['לא נמצאו תוצאות עבור "',A,'"']}),L.length>0&&(0,a.jsx)("button",{onClick:()=>{s("search"),_(!1)},className:"w-full p-4 text-center text-blue-600 hover:bg-blue-50 font-medium transition-colors",children:"צפה בכל התוצאות"})]}),{})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 md:gap-8 max-w-6xl mx-auto",children:[(0,a.jsx)(ep,{icon:(0,a.jsx)(g.A,{className:"h-7 w-7 text-green-600"}),title:"בסיס נתונים",description:"ניהול מאובטח של נתונים",onClick:()=>s("database"),hoverColor:"green"}),(0,a.jsx)(ep,{icon:(0,a.jsx)(j.A,{className:"h-7 w-7 text-blue-600"}),title:"מפה",description:"סינון על מפה",onClick:()=>s("map"),hoverColor:"blue"}),(0,a.jsx)(ep,{icon:(0,a.jsx)(p.A,{className:"h-7 w-7 text-purple-600"}),title:"יצ״מ - מגוייסים",description:"יחידות צמ״ה לפי אזורים",onClick:()=>s("yazam"),hoverColor:"purple"}),(0,a.jsx)(ep,{icon:(0,a.jsx)(b.A,{className:"h-7 w-7 text-yellow-600"}),title:"בעלים",description:"ניהול בעלי ציוד",onClick:()=>s("owners"),hoverColor:"yellow"}),(0,a.jsx)(ep,{icon:(0,a.jsx)(f.A,{className:"h-7 w-7 text-red-600"}),title:"סטטיסטיקה",description:"ניתוח נתונים וגרפים",onClick:()=>s("stats"),hoverColor:"red"}),(0,a.jsx)(ep,{icon:(0,a.jsx)(C.A,{className:"h-7 w-7 text-indigo-600"}),title:"מסננים",description:"סינון מתקדם של נתונים",onClick:()=>s("filters"),hoverColor:"indigo"})]}),(0,a.jsx)("div",{className:"mt-8 md:mt-16",children:(0,a.jsx)(U,{})})]})]})}let ep=e=>{let{icon:s,title:t,description:l,onClick:r,hoverColor:n}=e;return(0,a.jsx)("div",{onClick:r,className:"group bg-white rounded-2xl shadow-lg hover:shadow-xl transition-all duration-300 p-4 md:p-6 border border-gray-100 hover:border-".concat(n,"-500 cursor-pointer"),children:(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,a.jsx)("div",{className:"p-3 bg-".concat(n,"-50 rounded-xl group-hover:scale-110 transition-transform duration-300"),children:s}),(0,a.jsx)("h3",{className:"text-xl md:text-2xl font-bold text-gray-800",children:t})]}),(0,a.jsx)("p",{className:"text-gray-600 leading-relaxed text-sm md:text-base",children:l})]})})}},17146:(e,s,t)=>{"use strict";t.d(s,{A:()=>c,AuthProvider:()=>d});var a=t(95155),l=t(12115),r=t(6698),n=t(14565);let i=(0,l.createContext)({user:null,loading:!0,error:null,login:async()=>{throw Error("AuthContext not initialized")},logout:async()=>{throw Error("AuthContext not initialized")},canEdit:!1});function d(e){let{children:s}=e,[t,d]=(0,l.useState)(null),[c,o]=(0,l.useState)(!0),[x,m]=(0,l.useState)(null),[h,u]=(0,l.useState)(!1),g=async(e,s)=>{try{m(null),await (0,n.x9)(r.j,e,s)}catch(s){let e="שגיאת התחברות. אנא בדקו את הפרטים ונסו שוב.";throw m(e),Error(e)}},j=async()=>{try{await (0,n.CI)(r.j)}catch(s){let e="שגיאה בהתנתקות. אנא נסו שוב.";throw m(e),Error(e)}};return(0,l.useEffect)(()=>{let e=(0,n.hg)(r.j,e=>{d(e),u(!!e),o(!1)});return()=>e()},[]),(0,a.jsx)(i.Provider,{value:{user:t,loading:c,error:x,login:g,logout:j,canEdit:h},children:s})}function c(){return(0,l.useContext)(i)}},6698:(e,s,t)=>{"use strict";t.d(s,{O:()=>d,j:()=>i});var a=t(49904),l=t(14565),r=t(38698);let n=(0,a.Wp)({apiKey:"AIzaSyDdzBZXdCvnGbzatGfc47co58RNc7h6GSQ",authDomain:"geomai21.firebaseapp.com",databaseURL:"https://geomai21-default-rtdb.firebaseio.com",projectId:"geomai21",storageBucket:"geomai21.firebasestorage.app",messagingSenderId:"897053614981",appId:"1:897053614981:web:5c99107fc80fbcab881aec",measurementId:"G-FBRB6WPJF9"}),i=(0,l.xI)(n),d=(0,r.C3)(n)}},e=>{var s=s=>e(e.s=s);e.O(0,[507,371,756,28,441,517,358],()=>s(79496)),_N_E=e.O()}]);